---
title: "Models Report"

output:
  word_document: default
  html_document:
    highlight: null
editor_options:
  chunk_output_type: console
---
```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = FALSE,
                      comment = NA,
                      message = FALSE,
                      warning = FALSE,
                      results = 'asis',
                      error = TRUE)

# The following packages are installed and loaded 
library(data.table)
library(tidyr)
library(ggplot2)
library(ggrepel)
library(scales)
library(reshape2)
library(tibble)
library(caret)
library(plyr)
library(dplyr)
library(knitr)
library(extrafont)
```

```{r Functions and Data,echo=TRUE, include=FALSE}
cv <- function(formula, data, out.col, folds) {
  predictions <- list()
  if (folds == nrow(data)) {
    split.assign <- sample(1:folds, nrow(data), replace = F)
  } else {
    split.assign <- sample(1:folds, nrow(data), replace = T)
  }
  cvdat <- cbind(data, split.assign)
  colnames(cvdat)[dim(data)[2] + 1] <- "assign"
  for (i in 1:folds) {
    train <- cvdat[cvdat$assign != i, ]
    test <- cvdat[cvdat$assign == i, ]
    model <- lm(formula, data = train)
    predictions[[i]] <- data.frame(predict(model, newdata = test))
  }
  pred <- dplyr::bind_rows(predictions)
  pred <- pred[match(rownames(cvdat), rownames(pred)), ]
  sq.dis.cv <- data.frame(abs(pred - data[, out.col]))
  MAE.3cv <- mean(sq.dis.cv$abs.pred...data...out.col..)
  q2.3cv <- caret::R2(pred, data[, out.col])
  return(list(MAE.3cv, q2.3cv))
}

measure_cv <- function(formula, data, out.col, folds, iterations) {
  mae.list <- list()
  q2.list <- list()
  for (i in 1:iterations) {
    tool <- cv(formula, data, out.col, folds)
    mae.list[[i]] <- tool[[1]]
    q2.list[[i]] <- tool[[2]]
  }
  MAE.validation <- Reduce(`+`, mae.list) / iterations
  q2.validation <- Reduce(`+`, q2.list) / iterations
  return(list(MAE.validation, q2.validation))
}

sub_model <- function(data, out.col = dim(data)[2], min = 3, max = floor(dim(data)[1] / 5), folds = nrow(data), iterations = 1, cutoff = 0.85, cross.terms = F) {
  output <- stringr::str_c("`", names(data[out.col]), "`")
  vars <- names(data[, -out.col])
  for (i in 1:length(vars)) {
    vars[i] <- stringr::str_c("`", vars[i], "`")
  }
  comb.list <- list()
  ols.list <- list()
  q2.list <- list()
  mae.list <- list()
  if (cross.terms == T) {
    max <- max - 1
  }
  for (i in min:max) {
    comb.list[[i]] <- data.frame(aperm(combn(vars, i)), stringsAsFactors = F)
    comb.list[[i]][, dim(comb.list[[i]])[2] + 1] <- do.call(
      paste,
      c(comb.list[[i]][names(comb.list[[i]])],
        sep = " + "
      )
    )
    names(comb.list[[i]])[dim(comb.list[[i]])[2]] <- "formula"
    for (co in names(comb.list[[i]])[1:length(names(comb.list[[i]])) - 1]) comb.list[[i]][co] <- NULL
  }
  comb.list <- plyr::compact(comb.list)
  forms <- do.call(rbind, comb.list)
  if (cross.terms == T) {
    cross.list <- list()
    cross.list[[1]] <- data.frame(aperm(combn(vars, 2)), stringsAsFactors = F)
    cross.list[[2]] <- do.call(paste, c(cross.list[[1]][names(cross.list[[1]])], sep = " : "))
    repli_single <- do.call(rbind, replicate(length(cross.list[[2]]), forms, simplify = F))
    repli_single <- repli_single[order(repli_single), ]
    repli_cross <- do.call(c, replicate(nrow(forms), cross.list[[2]], simplify = F))
    new_comb <- list()
    for (i in 1:length(repli_cross)) {
      new_comb[[i]] <- paste(repli_single[[i]], repli_cross[[i]], sep = " + ")
    }
    orig.forms <- forms
    forms <- data.frame(do.call(rbind, plyr::compact(new_comb)), stringsAsFactors = F)
    names(forms) <- "formula"
    forms <- data.frame(rbind(orig.forms, forms))
    colnames(forms) <- "formula"
  }
  for (i in 1:dim(forms)[1]) {
    forms$formula[i] <- stringr::str_c(output, " ~ ", forms$formula[i])
    ols.list[[i]] <- summary(lm(forms[i, ], data = data))$r.squared
  }
  forms[, 2] <- do.call(rbind, ols.list)
  names(forms)[2] <- "R.sq"
  forms.cut <- forms[forms$R.sq > cutoff, ]
  while (nrow(forms.cut) == 0) {
    cutoff <- cutoff - 0.1
    forms.cut <- forms[forms$R.sq > cutoff, ]
  }
  for (i in 1:dim(forms.cut)[1]) {
    stts <- measure_cv(forms.cut[i, 1], data, out.col, folds, iterations)
    q2.list[[i]] <- stts[2]
    mae.list[[i]] <- stts[1]
  }
  forms.cut[, 3] <- data.table::transpose(do.call(rbind, q2.list))
  forms.cut[, 4] <- data.table::transpose(do.call(rbind, mae.list))
  names(forms.cut)[3:4] <- c("Q.sq", "MAE")
  return(head(dplyr::arrange(forms.cut, desc(forms.cut$Q.sq)), 2))
}

model.plot <- function(model = models[1,1], data = ba_mod_data) {
  best.mod <- lm(model, data = ba_mod_data)
  pred_interval <- predict(best.mod, newdata = ba_mod_data, interval = 'pre', level = 0.9)
  plot.dat <- data.frame(cbind(ba_mod_data$output, pred_interval))
  colnames(plot.dat) <- c('Measured', 'Predicted', 'lwr', 'upr')
  rownames(plot.dat) <- row.names(ba_mod_data)
  
  row.names(plot.dat) <- stringr::str_replace(row.names(plot.dat),"o_",'2-')
  row.names(plot.dat) <- stringr::str_replace(row.names(plot.dat),"m_",'3-')
  row.names(plot.dat) <- stringr::str_replace(row.names(plot.dat),"p_",'4-')
  row.names(plot.dat) <- stringr::str_replace(row.names(plot.dat),"o4-",'2,4-')
  row.names(plot.dat) <- stringr::str_replace(row.names(plot.dat),"m3-",'3,5-')
  row.names(plot.dat) <- stringr::str_replace(row.names(plot.dat),"3-naph",'2-naph')
  row.names(plot.dat) <- stringr::str_replace(row.names(plot.dat),"3-tfm",'3-CF3')
  row.names(plot.dat) <- stringr::str_replace(row.names(plot.dat),"4-tfm",'4-CF3')
  
  for (i in 1:nrow(plot.dat)) {
    if (grepl('3-',row.names(plot.dat)[i])) {
      plot.dat[i,5] <- 'meta'
    }
    if (grepl('2-',row.names(plot.dat)[i])) {
      plot.dat[i,5] <- 'ortho'
    }
    if (grepl('Ph',row.names(plot.dat)[i])) {
      plot.dat[i,5] <- 'Ph'
    }
    if (grepl('4-',row.names(plot.dat)[i])) {
      plot.dat[i,5] <- 'para'
    }
    if (grepl('2-naph',row.names(plot.dat)[i])) {
      plot.dat[i,5] <- 'meta'
    }
    if (grepl('3,5-',row.names(plot.dat)[i])) {
      plot.dat[i,5] <- 'meta'
    }
  }
  
  plot.dat <- dplyr::mutate(plot.dat, label = row.names(plot.dat))
  colnames(plot.dat)[5] <- 'Position'
  
  plot <- ggplot(plot.dat, aes(x = Measured, y = Predicted))+
    geom_point(size = 2, shape = 15,aes(color = Position))+
    stat_smooth(aes(y=lwr), color = "cadetblue", linetype = "dashed",
                se=F, method = 'lm', fullrange=T, size = 0.8)+
    stat_smooth(aes(y=upr), color = "cadetblue", linetype = "dashed", 
                se=F, method = 'lm', fullrange=T, size = 0.8)+
    labs(x = 'Measured log(d.r.)',y = 'Predicted log(d.r.)')+
    stat_smooth(method = 'lm',se = F, formula = y~x,
                color = 'black',fullrange=T, linetype = 'dashed')+
    theme(axis.line.x = element_line(size=1, colour = "black"),
          axis.line.y = element_line(size=1, colour = "black"),
          axis.text.x=element_text(colour="black", size = 12,face='bold'),
          axis.text.y=element_text(colour="black", size = 12,face='bold'),
          axis.title.x = element_text(colour="black", size = 12,face='bold'),
          axis.title.y = element_text(colour="black", size = 12,face='bold'),
          panel.grid.major = element_blank(),
          panel.grid.minor = element_blank(),
          panel.border = element_blank(), panel.background = element_blank(),
          legend.position = c(2,2))+
    scale_color_manual(values = c(Ph = "black", meta = 'tan1',
                                  para = '#66a182',ortho = '#d1495b'))+
    xlim(min(plot.dat[,3]), max(plot.dat[,4]))+
    ylim(min(plot.dat[,3]), max(plot.dat[,4]))+
    coord_fixed(ratio = 1)+
    geom_text_repel(size = 4.5,
                    aes(label = label),
                    min.segment.length = Inf,
                    seed = 42,
                    point.padding = 0.4,
                    segment.color = 'white',
                    force_pull = 0.02,
                    nudge_x = 0.022,
                    direction = 'y')+
    theme(text = element_text(family = 'Arial'))
  plot
}

mod.co <- function(model, data = ba_mod_data) {
  mod.sum <- summary(lm(model, data))
  k.mod <- knitr::kable(mod.sum$coefficients)
  print(k.mod)
}

```

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

## Neat

</div>

### Only Boronic Acids

```{r Model list - BA neat }
ba_mod_data <- data.frame(data.table::fread('BA_neat.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)
ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 1}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 1}
model.plot()
```



### With Catalyst - Close to the active site

```{r Model list - BA cat close long neat}
ba_mod_data <- data.frame(data.table::fread('proline_close_neat.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 5}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 5}
model.plot()
```

### With Catalyst -  far from the active site

```{r Model list - BA cat far long neat}
ba_mod_data <- data.frame(data.table::fread('proline_far_neat.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 6}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 6}
model.plot()
```




### BA + Pentanone

```{r Model list - BA pentanone 1}
ba_mod_data <- data.frame(data.table::fread('cyclopentanone_neat.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV pent 1}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot pent 1}
model.plot()
```








### BA + Aldehyde (pi interaction) - oxygen side

```{r Model list - BA - aldehyde Boron close 1}
ba_mod_data <- data.frame(data.table::fread('pi_inter_close_neat.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 1}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 1}
model.plot()
```










### BA + Aldehyde - pi interaction - hydrogen side

```{r Model list - BA - aldehyde Boron far 1}
ba_mod_data <- data.frame(data.table::fread('pi_inter_far_neat.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 1}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 1}
model.plot()
```













### BA + Aldehyde - H bond - aldehyde side

```{r Model list - BA - aldehyde Boron close 1 Pi}
ba_mod_data <- data.frame(data.table::fread('H_bond_close_neat.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 1 Pi}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 1 Pi}
model.plot()
```










### BA + Aldehyde - H bond - opposite to aldehyde

```{r Model list - BA - aldehyde Boron far 1 Pi}
ba_mod_data <- data.frame(data.table::fread('H_bond_far_neat.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 1 Pi}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 1 Pi}
model.plot()
```
















### Enamine - far from the active site
```{r Model list - BA - enamine far 1}
ba_mod_data <- data.frame(data.table::fread('enamine_far_neat.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine far 1}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine far 1}
model.plot()
```

### Enamine - close to the active site

```{r Model list - BA - enamine close 1}
ba_mod_data <- data.frame(data.table::fread('enamine_close_neat.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine close 1}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine close 1}
model.plot()
```





<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">
## ACN 
</div>
### Only Boronic Acids

```{r Model list - BA acn }
ba_mod_data <- data.frame(data.table::fread('BA_ACN.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)
ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 7}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 7}
model.plot()
```



### With Catalyst - Close to the active site 

```{r Model list - BA cat close long short acn}
ba_mod_data <- data.frame(data.table::fread('proline_close_ACN.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 10}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 10}
model.plot()
```

### With Catalyst -  far from the active site 

```{r Model list - BA cat far long acn}
ba_mod_data <- data.frame(data.table::fread('proline_far_ACN.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 11}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 11}
model.plot()
```




### BA + Pentanone

```{r Model list - BA pentanone 2}
ba_mod_data <- data.frame(data.table::fread('cyclopentanone_ACN.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV pent 2}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot pent 2}
model.plot()
```


### BA + Aldehyde (pi interaction) - oxygen side

```{r Model list - BA - aldehyde Boron close 2}
ba_mod_data <- data.frame(data.table::fread('pi_inter_close_ACN.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 2}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 2}
model.plot()
```










### BA + Aldehyde (pi interaction) - hydrogen side

```{r Model list - BA - aldehyde Boron far 2}
ba_mod_data <- data.frame(data.table::fread('pi_inter_far_ACN.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 2}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 2}
model.plot()
```












### BA + Aldehyde - H bond - aldehyde side

```{r Model list - BA - aldehyde Boron close 2 Pi}
ba_mod_data <- data.frame(data.table::fread('H_bond_close_ACN.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 2 Pi}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 2 Pi}
model.plot()
```










### BA + Aldehyde - H bond - opposite to aldehyde

```{r Model list - BA - aldehyde Boron far 2 Pi}
ba_mod_data <- data.frame(data.table::fread('H_bond_far_ACN.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 2 Pi}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 2 Pi}
model.plot()
```















### Enamine - far from the active site
```{r Model list - BA - enamine far 2}
ba_mod_data <- data.frame(data.table::fread('enamine_far_ACN.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine far 2}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine far 2}
model.plot()
```

### Enamine - close to the active site
```{r Model list - BA - enamine close 2}
ba_mod_data <- data.frame(data.table::fread('enamine_close_ACN.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine close 2}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine close 2}
model.plot()
```




<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">
## Methanol 
</div>
### Only Boronic Acids

```{r Model list - BA met }
ba_mod_data <- data.frame(data.table::fread('BA_methanol.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)
ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 12}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 12}
model.plot()
```



### With Catalyst - Close to the active site

```{r Model list - BA cat close long met}
ba_mod_data <- data.frame(data.table::fread('proline_close_methanol.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 15}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 15}
model.plot()
```

### With Catalyst -  far from the active site

```{r Model list - BA cat far long met}
ba_mod_data <- data.frame(data.table::fread('proline_far_methanol.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 16}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 16}
model.plot()
```





### BA + Pentanone

```{r Model list - BA pentanone 3}
ba_mod_data <- data.frame(data.table::fread('cyclopentanone_methanol.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)
ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV pent 3}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot pent 3}
model.plot()
```



### BA + Aldehyde (pi interaction) - oxygen side

```{r Model list - BA - aldehyde Boron close 3}
ba_mod_data <- data.frame(data.table::fread('pi_inter_close_methanol.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 3}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 3}
model.plot()
```










### BA + Aldehyde (pi interaction) - hydrogen side

```{r Model list - BA - aldehyde Boron far 3}
ba_mod_data <- data.frame(data.table::fread('pi_inter_far_methanol.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 3}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 3}
model.plot()
```













### BA + Aldehyde - H bond - aldehyde side

```{r Model list - BA - aldehyde Boron close 3 Pi}
ba_mod_data <- data.frame(data.table::fread('H_bond_close_methanol.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 3 Pi}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 3 Pi}
model.plot()
```










### BA + Aldehyde - H bond - opposite to aldehyde

```{r Model list - BA - aldehyde Boron far 3 Pi}
ba_mod_data <- data.frame(data.table::fread('H_bond_far_methanol.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 3 Pi}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 3 Pi}
model.plot()
```
















### Enamine - far from the active site
```{r Model list - BA - enamine far 3}
ba_mod_data <- data.frame(data.table::fread('enamine_far_methanol.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine far 3}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine far 3}
model.plot()
```

### Enamine - close to the active site
```{r Model list - BA - enamine close 3}
ba_mod_data <- data.frame(data.table::fread('enamine_close_methanol.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine close 3}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine close 3}
model.plot()
```





## Chloroform 

### Only Boronic Acids

```{r Model list - BA chcl }
ba_mod_data <- data.frame(data.table::fread('BA_chloroform.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)
ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 17 a}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 17 a}
model.plot()
```



### With Catalyst - Close 

```{r Model list - BA cat close long chcl}
ba_mod_data <- data.frame(data.table::fread('proline_close_chloroform.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 19}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 19}
model.plot()
```

### With Catalyst -  far

```{r Model list - BA cat far long chcl}
ba_mod_data <- data.frame(data.table::fread('proline_far_chloroform.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 20}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 20}
model.plot()
```




### BA + Pentanone

```{r Model list - BA pentanone 4}
ba_mod_data <- data.frame(data.table::fread('cyclopentanone_chloroform.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)
ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV pent 4}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot pent 4}
model.plot()
```


### BA + Aldehyde (pi interaction) - oxygen side

```{r Model list - BA - aldehyde Boron close 4}
ba_mod_data <- data.frame(data.table::fread('pi_inter_close_chloroform.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 4}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 4}
model.plot()
```










### BA + Aldehyde (pi interaction) - hydrogen side

```{r Model list - BA - aldehyde Boron far 4}
ba_mod_data <- data.frame(data.table::fread('pi_inter_far_chloroform.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 4}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 4}
model.plot()
```













### BA + Aldehyde - H bond - aldehyde side

```{r Model list - BA - aldehyde Boron close 4 Pi}
ba_mod_data <- data.frame(data.table::fread('H_bond_close_chloroform.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 4 Pi}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 4 Pi}
model.plot()
```










### BA + Aldehyde - H bond - opposite to aldehyde

```{r Model list - BA - aldehyde Boron far 4 Pi}
ba_mod_data <- data.frame(data.table::fread('H_bond_far_chloroform.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 4 Pi}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 4 Pi}
model.plot()
```
















### Enamine - far from the active site
```{r Model list - BA - enamine far 4}
ba_mod_data <- data.frame(data.table::fread('enamine_far_chloroform.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine far 4}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine far 4}
model.plot()
```

### Enamine - close to the active site
```{r Model list - BA - enamine close 4}
ba_mod_data <- data.frame(data.table::fread('enamine_close_chloroform.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine close 4}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine close 4}
model.plot()
```







<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">
## Hexane 
</div>
### Only Boronic Acids
```{r Model list - BA - hex ba}
ba_mod_data <- data.frame(data.table::fread('BA_hexane.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - hex ba close 4}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - hex ba close 4}
model.plot()
```


### With Catalyst - Close to the active site 

```{r Model list - BA cat close long hex}
ba_mod_data <- data.frame(data.table::fread('proline_close_hexane.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 19 1}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 19 1}
model.plot()
```

### With Catalyst -  far from the active site

```{r Model list - BA cat far long hex}
ba_mod_data <- data.frame(data.table::fread('proline_far_hexane.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 20 1}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 20 1}
model.plot()
```




### BA + Aldehyde (pi interaction) - oxygen side

```{r Model list - BA - aldehyde Boron close 5}
ba_mod_data <- data.frame(data.table::fread('pi_inter_close_hexane.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 5}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 5}
model.plot()
```










### BA + Aldehyde (pi interaction) - hydrogen side

```{r Model list - BA - aldehyde Boron far 5}
ba_mod_data <- data.frame(data.table::fread('pi_inter_far_hexane.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 5}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 5}
model.plot()
```












### BA + Aldehyde - H bond - aldehyde side

```{r Model list - BA - aldehyde Boron close 5 Pi}
ba_mod_data <- data.frame(data.table::fread('H_bond_close_hexane.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 5 Pi}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 5 Pi}
model.plot()
```










### BA + Aldehyde - H bond - opposite to aldehyde

```{r Model list - BA - aldehyde Boron far 5 Pi}
ba_mod_data <- data.frame(data.table::fread('H_bond_far_hexane.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 5 Pi}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 5 Pi}
model.plot()
```













### Enamine - far from the active site
```{r Model list - BA - enamine far 5}
ba_mod_data <- data.frame(data.table::fread('enamine_far_hexane.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine far 5}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine far 5}
model.plot()
```

### Enamine - close to the active site
```{r Model list - BA - enamine close 5}
ba_mod_data <- data.frame(data.table::fread('enamine_close_hexane.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine close 5}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine close 5}
model.plot()
```






<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">
## Hexane  - against ee
</div>
### Only Boronic Acids
```{r Model list - BA - hex ba ee}
ba_mod_data <- data.frame(data.table::fread('BA_hexane_ddG.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - hex ba close 4 ee}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - hex ba close 4 ee}
model.plot()
```


### With Catalyst - Close to the active site 

```{r Model list - BA cat close long hex ee}
ba_mod_data <- data.frame(data.table::fread('proline_close_hexane_ddG.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 19 1 ee}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 19 1 ee}
hexane_plot <- model.plot()
```

### With Catalyst -  far

```{r Model list - BA cat far long hex ee}
ba_mod_data <- data.frame(data.table::fread('proline_far_hexane_ddG.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV 20 1 ee}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot 20 1 ee}
model.plot()
```




### BA + Aldehyde (pi interaction) - oxygen side

```{r Model list - BA - aldehyde Boron close 5 ee}
ba_mod_data <- data.frame(data.table::fread('pi_inter_close_hexane_ddG.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 5 ee}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 5 ee}
model.plot()
```










### BA + Aldehyde (pi interaction) - hydrogen side

```{r Model list - BA - aldehyde Boron far 5 ee}
ba_mod_data <- data.frame(data.table::fread('pi_inter_far_hexane_ddG.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 5 ee}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 5 ee}
model.plot()
```












### BA + Aldehyde - H bond - aldehyde side

```{r Model list - BA - aldehyde Boron close 5 Pi ee}
ba_mod_data <- data.frame(data.table::fread('H_bond_close_hexane_ddG.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron close 5 Pi ee}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron close 5 Pi ee}
model.plot()
```










### BA + Aldehyde - H bond - opposite to aldehyde

```{r Model list - BA - aldehyde Boron far 5 Pi ee}
ba_mod_data <- data.frame(data.table::fread('H_bond_far_hexane_ddG.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - aldehyde Boron far 5 Pi ee}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - aldehyde Boron far 5 Pi ee}
model.plot()
```













### Enamine - far from the active site
```{r Model list - BA - enamine far 5 ee}
ba_mod_data <- data.frame(data.table::fread('enamine_far_hexane_ddG.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine far 5 ee}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine far 5 ee}
model.plot()
```

### Enamine - close to the active site
```{r Model list - BA - enamine close 5 ee}
ba_mod_data <- data.frame(data.table::fread('enamine_close_hexane_ddG.csv',header = T,check.names = T))
row.names(ba_mod_data) <- ba_mod_data[,1]
ba_mod_data <- ba_mod_data[,-1]
CN <- names(ba_mod_data)

ba_mod_data <- data.frame(cbind(scale(ba_mod_data[,1:dim(ba_mod_data)[2]-1], T, T),ba_mod_data$output))
names(ba_mod_data) <- CN
models <- sub_model(ba_mod_data, min = 3, max = 3)
tab <- knitr::kable(models)
print(tab)
mod.co(models[1,1])


```

***3 & 5 fold CV***
```{r CV BA - enamine close 5 ee}
cv_3fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 3, 500)
dt3 <- data.frame(cv_3fold[[2]], cv_3fold[[1]])
names(dt3) <- c('Q2', 'MAE')
tab_dt3 <- knitr::kable(dt3)
print(tab_dt3)
cv_5fold <- measure_cv(models[1,1], ba_mod_data, dim(ba_mod_data)[2], 5, 500)
dt5 <- data.frame(cv_5fold[[2]], cv_5fold[[1]])
names(dt5) <- c('Q2', 'MAE')
tab_dt5 <- knitr::kable(dt5)
print(tab_dt5)
```
***Top Ranked Full Model***

```{r plot BA - enamine close 5 ee}
model.plot()
```





